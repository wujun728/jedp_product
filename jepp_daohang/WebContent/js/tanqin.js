(function(){var e="menupiano-extra-hover";if(!Musical.isCanUse()){qboot.load.css(".menupiano-extra .update-browser{background-color:#f8f8f8;border:1px solid #c8cacd;color:#999;display:none;padding:8px 5px 5px;position:absolute;right:-1px;top:36px;width:102px;z-index:1}.menupiano-extra-hover .update-browser{display:block}.menupiano-extra .update-browser a{color:#e60012;font-size:14px;text-decoration:underline}.menupiano-extra .update-browser .go-download{margin:4px 0;text-align:center}.ie6 .menupiano-extra .update-browser{right:-2px}"),W("#menupiano-extra").insertAdjacentHTML("beforeend",'<ul class="update-browser"><li>\u5f00\u542f\u83dc\u5355\u94a2\u7434\u9700\u8981\u5347\u7ea7\u6d4f\u89c8\u5668</li><li class="go-download"><a href="http://down.360safe.com/se/cdnse.exe" hidefocus="true">\u9a6c\u4e0a\u5347\u7ea7</a></li></ul>'),qboot.await(function(){return window.QW&&window.M},function(){M("#longlong-frame",function(t,n){n.query("#menupiano-extra,#menupiano-setting").on("click",function(n){t("#menupiano-extra").addClass(e)}),t(document).click(function(n){var r=t(n.target),i=!r.parentNode("#menupiano-extra").length&&r[0].id!="menupiano-extra",s=!r.parentNode("#menupiano-setting").length&&r[0].id!="menupiano-setting";i&&s&&t("#menupiano-extra").removeClass(e)})})},null,100,100);return}var t="#piano-tips{z-index:100;position:absolute;top:186px;right:-22px;width:33px;}#piano-tips .pic{margin-bottom:8px;width:33px;}#piano-tips .close{display:block;margin-left:20px;width:10px;height:8px;line-height:8px;font-size:18px;text-align:center;color:#b9b9b9;}#piano-tips .close:hover{text-decoration:none;color:#3286ca;}.ie6 #piano-tips .close{margin-left:16px;line-height:26px;}";t+=".menupiano-extra .extra-list{border:1px solid #c8cacd;display:none;position:absolute;right:-1px;top:36px;width:102px;z-index:1}.menupiano-extra .extra-list a{background-color:#f8f8f8;color:#666;font-family:simsun;line-height:34px;text-align:center}.menupiano-extra .extra-list a,.menupiano-extra-hover .extra-list{display:block}.menupiano-extra .extra-list a{border-bottom:1px dotted #c8cacd;}.menupiano-extra .extra-list .go{border-bottom:none;}.menupiano-extra .extra-list .btn-opern,.menupiano-extra .extra-list .btn-record{height:34px;padding-left:24px;text-align:left}.menupiano-extra .extra-list .btn-opern{background-position:8px -37px}.menupiano-extra .extra-list .btn-record{background-position:8px -76px}.menupiano-extra .extra-list a:hover{background-color:#fefefe;text-decoration:none}#qinpu{border:none;width:100%}#menupiano-panel{position:absolute;top:37px;background:#fbfbfb;border:1px solid #c9cbce;display:none;font-family:simsun;width:998px;z-index:1}#menupiano-panel .record-info{height:18px;line-height:12px;text-align:center;color:#f00}#menupiano-panel .record-state{color:#989898;font-size:14px;font-weight:400;height:48px;line-height:48px;text-align:center}#menupiano-panel .record-state img{margin-left:4px;vertical-align:middle}#menupiano-panel .record-panel{height:48px;line-height:48px;text-align:center}#menupiano-panel .record-share{padding-top:12px;height:38px;text-align:center}#menupiano-panel .close-btn{background:#c7c7c7;color:#fff;font-size:22px;font-weight:700;height:22px;line-height:22px;line-height:26px\\9;overflow:hidden;position:absolute;right:4px;text-align:center;top:4px;width:22px}#menupiano-panel .record-share span{color:#999}#menupiano-panel .record-share a{display:inline-block;margin-right:20px;padding-left:22px;color:#666}#menupiano-panel .record-share a:hover{color:#e60012}#menupiano-panel .record-panel .btn{-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;color:#fff;display:inline-block;font-size:14px;font-weight:700;height:30px;line-height:30px;margin-right:5px;width:107px}#menupiano-panel .record-panel .record-start,#menupiano-panel .record-panel .audition-start{background:#3fbc0a;border:1px solid #3cad0d}#menupiano-panel .record-panel .record-finish{background:#f93;border:1px solid #f37f0b}#menupiano-panel .record-panel .cancel-btn,#menupiano-panel .record-panel .gorecord-btn{color:#666;font-size:14px;line-height:30px;text-decoration:underline}#menupiano-panel .record-share .copy-link{background-position:0 -253px;color:#f60;}#menupiano-panel .record-share .hover{color:red;text-decoration:underline;}#menupiano-panel .record-share .sina-weibo{background-position:0 -215px}#menupiano-panel .record-share .renren{background-position:0 -182px}#menupiano-panel .record-share .qqzone{background-position:0 -140px}#menupiano-panel .close-btn:hover{background:#47b902}#menupiano-panel .close-btn:hover,#menupiano-panel .record-panel .btn:hover{text-decoration:none}#menupiano-panel .record-panel .record-start:hover,#menupiano-panel .record-panel .audition-start:hover{background:#4dc818}#menupiano-panel .record-panel .record-finish:hover{background:#fda64e}#menupiano-panel .record-panel .cancel-btn:hover,#menupiano-panel .record-panel .gorecord-btn:hover{color:#e60012;text-decoration:underline}.menupiano-extra .extra-list .btn-opern,.menupiano-extra .extra-list .btn-record,#menupiano-panel .record-share a{background-image:url(http://p1.qhimg.com/t01b5d5d4e01bfa784e.png);background-repeat:no-repeat}#menupiano-panel .song-iframe,#menupiano-panel .song-record,#menupiano-panel .record-success{display:none}#menupiano-panel .song-record{position:relative}#menupiano-panel .record-success{padding-top:16px}#menupiano-panel .record-area{padding-bottom:18px}",qboot.load.css(t,"menupiano"),W("#menupiano-extra").insertAdjacentHTML("beforeend",'<ul class="extra-list g-hide"><li><a class=btn-opern>\u770b\u8c31\u5f39\u7434</a></li><li><a class=btn-record>\u5f55\u5236\u94a2\u7434\u66f2</a></li>'+(window.plugins.data.menupiano_extra.dropDownCont||"")+'<li><a href="http://www.dwz.cn/vljwH" class="go">\u67e5\u770b\u5f39\u594f\u653b\u7565&gt;&gt;</a></li></ul>'),W("#longlong-frame").insertAdjacentHTML("beforeend",'<div id=menupiano-panel class=g-hide> <div class=song-iframe><iframe src="" id="qinpu" frameborder="0" scrolling="no" allowtransparency="true" height="128"></iframe></div> <div id="song-record" class="song-record"> <div class=record-area><h3 class=record-state>\u70b9\u51fb\u5f00\u59cb\u5f55\u5236\u540e\uff0c\u4f7f\u7528\u9f20\u6807\u6216\u952e\u76d8\u5f39\u594f\u5f00\u59cb\u5f39\u594f</h3> <div class=record-panel> <a class="btn record-start">\u5f00\u59cb\u5f55\u5236</a> <a class="btn record-finish">\u5b8c\u6210\u5f55\u5236</a> <a class=cancel-btn>\u53d6\u6d88</a> </div> <div class=record-info>\u60a8\u8c8c\u4f3c\u6ca1\u6709\u5f39\u594f\uff0c\u5148\u5f39\u4e00\u66f2\u5427~</div> </div> <div class=record-success> <div class="record-info">\u60a8\u521a\u624d\u6ca1\u6709\u5f55\u5236\u4efb\u4f55\u5185\u5bb9\uff0c\u91cd\u65b0\u5f55\u5236\u5427~</div><div class=record-panel> <a class="btn audition-start">\u9a6c\u4e0a\u8bd5\u542c</a> <a class=gorecord-btn>\u91cd\u65b0\u5f55\u5236</a> </div> <div class=record-share> <a class=copy-link id=copy-link>\u590d\u5236\u4f60\u5f39\u7684\u6b4c\u66f2\u94fe\u63a5</a> <span>\u5206\u4eab\u7ed9\u597d\u53cb\u663e\u6446\u4e00\u4e0b\uff1a</span> <a class="sina-weibo">\u65b0\u6d6a\u5fae\u535a</a> <a class="qqzone">QQ\u7a7a\u95f4</a> <a class="renren">\u4eba\u4eba\u7f51</a> </div> </div> </div> <a class=close-btn title=\u5173\u95ed>\u00d7</a> </div>'),qboot.await(function(){return window.QW&&window.M&&hao360.g("menupiano-panel")&&W("#menupiano-panel").css("position")=="absolute"},function(){var t=function(){W("#menupiano-extra .g-hide , #menupiano-extra .g-hide").removeClass("g-hide")};t(),M("#longlong-frame",function(t,n){function v(e){n.tweet("menu-extra-total-silent"),t(".record-area").show(),t(".record-success").hide(),t(".record-info").hide(),c.show(),l.hide(),t(".cancel-btn").hide(),d.html("\u70b9\u51fb\u5f00\u59cb\u5f55\u5236\uff0c\u53ef\u4ee5\u628a\u4f60\u5f39\u594f\u7684\u66f2\u5b50\u5f55\u5236\u4e0b\u6765")}function m(e){c.hide(),l.show(),t(".cancel-btn").show(),d.html("\u6b63\u5728\u5f55\u5236\uff0c\u8bf7\u4f7f\u7528\u9f20\u6807\u6216\u952e\u76d8\u5f39\u594f<img src='http://p1.qhimg.com/t01a4815c7d997751b0.gif' />"),r.stop(),r.record()}function y(e){c.hide(),l.show(),t(".record-area").hide(),t(".record-success").show(),r.stop(),i.getData().length||t(".record-info").show();var n=b();t(".copy-link").attr("href",n),t(".sina-weibo,.renren,.qqzone").forEach(function(e){s(e,n)}),g===null&&(g=new ZClipboard("copy-link","song-record"),g.on("complete",function(e){alert("\u590d\u5236\u6210\u529f\uff0c\u628a\u94fe\u63a5\u53d1\u7ed9\u4f60\u7684\u597d\u53cb\u542c\u4e00\u542c\u5427\uff01")})),g.copy(n)}function b(){var e=r.getTape(),t="#music"+e.getData().join("-"),n="http://"+location.host+location.pathname+location.search+t;return n}var r=new TapeDeck,i=new Tape;r.load(i);var s=function(e,t){var n,r=e.className,i=encodeURIComponent("http://ww2.sinaimg.cn/bmiddle/6b7c1897jw1e6alqacmvvj20c20lztbe.jpg");t=encodeURIComponent(t);switch(r){case"sina-weibo":var s=encodeURIComponent("\u4f60\u4e0d\u77e5\u9053\u5427\uff1f\u5176\u5b9e\u6211\u4e5f\u4f1a\u5f39\u94a2\u7434\uff0c\u5c31\u77e5\u9053\u4f60\u4eec\u4e0d\u4fe1\uff0c\u6240\u4ee5\u7279\u610f\u5f55\u4e86\u4e00\u9996\uff0c\u4e0d\u4fe1\u4f60\u6765\u542c\u542c\uff01\u4e0d\u8981\u592a\u5d07\u62dc\u6211[\u574f\u7b11]");n="http://v.t.sina.com.cn/share/share.php?appkey=4062901765&ralateUid=2003206347&url="+t+"&title="+s+"&pic="+i;break;case"qqzone":var s=encodeURIComponent("\u5168\u6c11\u94a2\u7434\u6765\u88ad\u2014\u2014360\u5bfc\u822a"),o=encodeURIComponent("\u4f60\u4e0d\u77e5\u9053\u5427\uff1f\u5176\u5b9e\u6211\u4e5f\u4f1a\u5f39\u94a2\u7434\uff0c\u5c31\u77e5\u9053\u4f60\u4eec\u4e0d\u4fe1\uff0c\u6240\u4ee5\u7279\u610f\u5f55\u4e86\u4e00\u9996\uff0c\u4e0d\u4fe1\u4f60\u6765\u542c\u542c\uff01"),u=encodeURIComponent("6\u67089\u53f7360\u5bfc\u822a\u6709\u4e86\u94a2\u7434\uff0c\u4eca\u5929\u53c8\u5e26\u6765\u4e24\u4efd\u60ca\u559c\uff1a\u770b\u8c31\u5f39\u7434\u548c\u5f55\u5236\u6b4c\u66f2\u3002 \u5168\u6c11\u94a2\u7434\u5373\u5c06\u6765\u88ad\uff0c\u5feb\u6765\u5f39\u4e00\u9996\u5427\uff01");n="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+t+"&pics="+i+"&title="+s+"&desc="+o+"&summary="+u;break;case"renren":n="http://share.renren.com/share/buttonshare.do?&link="+t}n&&(e.href=n)};if(window.plugins.data.menupiano_extra.tipCont){var o=new Tips({el:t('<div id="piano-tips">'+window.plugins.data.menupiano_extra.tipCont+'<a class="close" title="\u5173\u95ed">\u00d7</a></div>'),parent:QW.W("#doc-main-front"),expires:30,tipName:"piano_"+(window.plugins.data.menupiano_extra.tipKey||"")});o.el.query(".close").click(function(){o.hide()}),n.receive("page-size-changed",function(e){var t=e.data.spaceWidth;t>35?(o.show(),o.el.show()):o.el.hide()}),Page.spaceWidth()>35&&o.show(),qboot.cookie.remove("kanpuluyin_tips")}var u=t("#menupiano-extra"),a=!0;u.hover(function(t){t.preventDefault(),a=!1,setTimeout(function(){a||(o&&o.hide(),u.addClass(e),n.query("#qinpu").attr("src").indexOf("qinpu.html")==-1&&n.query("#qinpu").attr("src","./qinpu.html"))},200)},function(t){a=!0,setTimeout(function(){a&&u.removeClass(e)},200)}).query(".extra-list").on("click",function(t){u.removeClass(e)}),u.query(".btn-opern").on("click",function(e){e.preventDefault(),n.tweet("menupiano-tip-close"),n.tweet("menu-extra-opern-open"),n.tweet("menu-extra-off-mute")}),u.query(".btn-record").on("click",function(e){e.preventDefault(),n.tweet("menupiano-tip-close"),n.tweet("menu-extra-record-open"),n.tweet("menu-extra-off-mute")});var f=t("#menupiano-panel");f.query(".close-btn").on("click",function(e){e.preventDefault(),n.query("#menupiano-panel").hide(),r.stop()}),f.delegate(".record-start","click",function(e){e.preventDefault(),m()}).delegate(".record-finish","click",function(e){e.preventDefault(),y()}),f.query(".gorecord-btn,.cancel-btn").on("click",function(e){e.preventDefault(),v()}),f.query(".audition-start").on("click",function(e){e.preventDefault(),n.tweet("menu-extra-total-silent"),r.play()}),f.query(".copy-link").on("click",function(e){e.preventDefault();var t=this.href;window.prompt("\u628a\u97f3\u4e50\u5206\u4eab\u7ed9\u4f60\u7684\u597d\u53cb\u5427\uff0c\u6309CTRL+C\u590d\u5236\u94fe\u63a5\uff01",t)});var l=t(".record-finish"),c=t(".record-start"),h=t(".song-record"),p=t(".song-iframe"),d=t(".record-state"),g=null;n.receive("menu-extra-opern-open",function(e){n.tweet("menu-extra-total-silent"),QW.W("#menupiano-panel").show(),p.show(),h.hide();var r={ns:"qinpu",operate:"showSongList"};window.postMessage&&t("#qinpu")[0].contentWindow.postMessage(JSON.stringify(r),"*")}),n.receive("menu-extra-record-open",function(e){QW.W("#menupiano-panel").show(),h.show(),p.hide(),v(),r.stop()}),n.receive("menu-extra-total-silent",function(e){r.stop()}),window.addEventListener&&window.addEventListener("message",function(e){var n;try{n=JSON.parse(e.data)}catch(i){}if(!n||!n.ns||n.ns!="qinpu")return;if(n.operate==="resetHeight"){var s=n.height>100?n.height:100;t("#qinpu").css("height",s+"px")}else n.operate==="showRecord"?(h.show(),v()):n.operate==="hideRecord"&&(h.hide(),r.stop())})})},null,100,100)})();